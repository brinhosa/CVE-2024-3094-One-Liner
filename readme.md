# CVE-2024-3094 One Liner Vulnerability Checker

This repository provides simple yet powerful one-liner scripts designed to help you quickly determine if your server is vulnerable to CVE-2024-3094, a critical security vulnerability found in certain versions of the `xz` utility. Additionally, we offer a convenient way to scan your code repositories for references to the `xz` library, which might be indicative of potential indirect vulnerabilities.

## Check Server Vulnerability

To ascertain whether your server is susceptible to CVE-2024-3094, execute the following command in your terminal:
```bash
(type dpkg &>/dev/null && dpkg -l xz 2>/dev/null | awk '/^ii/{print $3}' | grep -qE '^(5.6.0|5.6.1)$' && echo "Vulnerable: CVE-2024-3094" || echo "Not vulnerable or xz not installed") || (type rpm &>/dev/null && rpm -q --qf "%{VERSION}\n" xz 2>/dev/null | grep -qE '^(5.6.0|5.6.1)$' && echo "Vulnerable: CVE-2024-3094" || echo "Not vulnerable or xz not installed")
```

The above command will check for the packages in the Linux distro.


Or try this other option where the xz command will be executed, this is usually not recommended:
```bash
command -v xz &>/dev/null && { xz_version=$(xz --version | head -n 1 | awk '{print $4}'); [[ $xz_version == "5.6.0" || $xz_version == "5.6.1" ]] && echo "Vulnerable: CVE-2024-3094" || echo "Not vulnerable: CVE-2024-3094"; } || echo "xz not installed"
```

This script performs the following actions:
- Checks if the `xz` utility is installed.
- Determines the installed version of `xz`.
- Compares the version against known vulnerable versions (5.6.0 and 5.6.1).
- Outputs the vulnerability status of your server.

## Scan Code Repositories for `xz` References

If you're maintaining code that potentially interacts with or depends on the `xz` library, it's crucial to identify any explicit references to vulnerable library versions. Use the following commands to scan your repositories:

### Search for "tukaani" References

The `tukaani` project is the home of the `xz` utility. To find mentions within your code:

```bash
grep -rnH "tukaani" .
```

### Search for Maven Dependency References

For Java projects using Maven, you might specify `xz` as a dependency in your `pom.xml`. To locate these references:

```bash
grep -rnH "org.tukaani:xz:" .
```

These commands will recursively search the current directory (and subdirectories) for the specified patterns, reporting the file name, line number, and the line containing the match.

---

**Note:** Ensure you have the necessary permissions to run these scripts on your server or to scan repositories. Always verify and test scripts in a safe environment before use in production systems.

Feel free to contribute or suggest improvements to this repository by submitting a pull request or opening an issue. Your feedback and contributions are highly appreciated!

